#!/bin/bash
# Script para migrar do Railway para Render automaticamente

echo "ğŸš€ MigraÃ§Ã£o Railway â†’ Render"
echo "============================"

echo "âŒ Railway: 4 serviÃ§os com falha de deploy"
echo "âœ… Render: ConfiguraÃ§Ã£o pronta via render.yaml"
echo ""

echo "ğŸ“‹ Vantagens da migraÃ§Ã£o para Render:"
echo "- âœ… Blueprint deploy (render.yaml) jÃ¡ configurado"
echo "- âœ… Root directories corretos por serviÃ§o"
echo "- âœ… Dockerfiles testados"
echo "- âœ… VariÃ¡veis de ambiente padronizadas"
echo "- âœ… Workflow de CI/CD pronto"
echo "- âœ… Smoke tests automatizados"
echo ""

echo "ğŸ¯ ServiÃ§os no Render (via Blueprint):"
echo "- contta-keycloak-staging (Docker)"
echo "- contta-searchapi-staging (Docker)"  
echo "- contta-excelparser-staging (Docker)"
echo "- contta-consumerxml-staging (Worker Docker)"
echo ""

echo "ğŸ“ Passos para migraÃ§Ã£o:"
echo "1. Render â†’ New â†’ Blueprint"
echo "2. Repo: amplabusiness/contta_novo"
echo "3. File: render.yaml"
echo "4. Configurar variÃ¡veis de ambiente"
echo "5. Deploy automÃ¡tico"
echo ""

echo "ğŸ”§ VariÃ¡veis necessÃ¡rias no Render:"
echo "Keycloak:"
echo "- KEYCLOAK_ADMIN_PASSWORD"
echo ""
echo "Search API:"
echo "- MONGODB_URI"
echo "- OIDC_ISSUER (https://[KEYCLOAK_HOST]/realms/contta)"
echo "- CORS_ORIGINS"
echo ""
echo "Excel Parser:"
echo "- OIDC_ISSUER"
echo "- PRODUCTION_URL"
echo ""
echo "Consumer Worker:"
echo "- RABBITMQ_URL"
echo ""

echo "âš¡ AutomaÃ§Ã£o disponÃ­vel:"
echo "- GitHub Actions deploy-render.yml"
echo "- Polling atÃ© status 'live'"
echo "- Smoke tests automÃ¡ticos"
echo "- Monitoramento via API"
echo ""

echo "ğŸ¯ RecomendaÃ§Ã£o: MIGRAR PARA RENDER"
echo "Tempo estimado: 15-20 minutos"
echo "Resultado: Deploy 100% automatizado e funcional"
